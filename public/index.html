<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GPS ä»»å‹™ç³»çµ± - åœ°æ–¹é–‹ç®±ä»»å‹™éŠæˆ²</title>
  
  <!-- PWA é…ç½® -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#2196f3">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="GPS ä»»å‹™">
  <link rel="apple-touch-icon" href="/images/mascot.png">
  
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="icon" type="image/png" href="/images/mascot.png" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    /* PWA iOS å®‰è£å¼•å°æ¨£å¼ (ä¿ç•™åŠŸèƒ½) */
    #pwa-install-prompt {
      display: none;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      z-index: 10000;
      width: 90%;
      max-width: 400px;
      text-align: center;
      animation: slideUp 0.3s ease-out;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateX(-50%) translateY(20px); }
      to { opacity: 1; transform: translateX(-50%) translateY(0); }
    }

    #pwa-install-prompt p { margin: 0 0 15px 0; color: #333; font-size: 14px; line-height: 1.5; }
    #pwa-install-prompt img { vertical-align: middle; margin: 0 4px; }
    #pwa-install-prompt button {
      background: #2196f3; color: white; border: none; padding: 10px 20px;
      border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer;
    }
  </style>
</head>
<body>
  <header id="mainHeader">
    <div class="header-content" id="headerContent">
      <h1 id="pageTitle">GPS ä»»å‹™ç³»çµ±</h1>
      <button id="hamburgerBtn" class="hamburger" aria-label="å±•é–‹é¸å–®">&#9776;</button>
      <nav class="main-nav">
        <a href="/index.html" class="current-page">é¦–é </a>
        <a href="/map.html">åœ°åœ–é </a>
        <a href="/tasks-list.html" id="navTasksList">ä»»å‹™åˆ—è¡¨</a>
        <a href="/user-tasks.html">ä»»å‹™å¯©æ ¸</a>
        <a href="/staff-dashboard.html" id="navStaff" style="display:none;">æ–°å¢ä»»å‹™</a>
        <a href="/role-management.html" id="navRoleMgmt" style="display:none;">æ¬Šé™ç®¡ç†</a>
        <a href="/user-dashboard.html" id="navUserTasks" style="display:none;">ç”¨æˆ¶ä»»å‹™ç®¡ç†</a>
        <a href="/products.html" id="navProducts">å•†å“å…Œæ›</a>
        <a href="/redeem-tasks.html" id="navRedeem" style="display:none;">å…Œæ›å•†å“ç®¡ç†</a>
        <!-- æ–°å¢: AI å¯¦é©—å®¤å…¥å£ -->
        <a href="/ai-lab.html" style="color: #ffd700;">ğŸ¤– AI å¯¦é©—å®¤</a>
        
        <span id="loginUserInfo" style="color:#eee; margin-left:15px;"></span>
        <button id="logoutBtn" style="display:none;">ç™»å‡º</button>
      </nav>
    </div>
  </header>

  <!-- PWA iOS å®‰è£å¼•å° -->
  <div id="pwa-install-prompt">
    <p>æƒ³æ¥æ”¶å³æ™‚ä»»å‹™é€šçŸ¥å—ï¼Ÿé»æ“Šä¸‹æ–¹ <img src="/images/red-arrow.svg" width="20" alt="åˆ†äº«æŒ‰éˆ•"> å¾Œé¸æ“‡<strong>ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</strong></p>
    <button onclick="document.getElementById('pwa-install-prompt').style.display='none'">æˆ‘çŸ¥é“äº†</button>
  </div>

  <main>
    <!-- ä¸»è¦æ©«å¹…å€åŸŸ -->
    <section class="hero-section">
      <div class="hero-image" style="width:120px;height:120px;margin:0 auto 20px;border-radius:50%;overflow:hidden;box-shadow:0 4px 10px rgba(0,0,0,0.1);">
        <img src="/images/mascot.png" alt="å‰ç¥¥ç‰©" style="width:100%;height:100%;object-fit:cover;" onerror="this.src='/images/banner.png'">
      </div>
      <h1 class="hero-title">åœ°æ–¹é–‹ç®±ä»»å‹™éŠæˆ²</h1>
      <p class="hero-description">
        æ­¡è¿ä¾†åˆ°ä»»å‹™é€²åº¦ç³»çµ±ï¼é€™è£¡æ˜¯å°ˆç‚ºåœ°æ–¹ã€åé„‰ã€ç¤¾å€è¨­è¨ˆçš„äº’å‹•è¡ŒéŠ·å¹³å°ï¼Œ<br>
        é€éä¸€å€‹å€‹æœ‰è¶£çš„ä»»å‹™ï¼Œå¸¶ä½ é–‹ç®±åœ¨åœ°æ–‡åŒ–ã€é¢¨æ™¯ã€ç¾é£Ÿèˆ‡æ•…äº‹ã€‚
      </p>

      <div class="hero-buttons">
        <button class="btn-primary" onclick="window.location.href='/map.html'">
          ğŸŒ ç«‹å³æ¢ç´¢åœ°åœ–
        </button>
        <button class="btn-secondary" onclick="window.location.href='/tasks-list.html'">
          ğŸ“‹ æŸ¥çœ‹ä»»å‹™åˆ—è¡¨
        </button>
      </div>

      <div id="authBtns" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;"></div>
    </section>

    <!-- åŠŸèƒ½ç‰¹è‰²å€åŸŸ -->
    <section class="features-section">
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">
            <img src="/images/feature-map.png" alt="åœ°åœ–äº’å‹•">
          </div>
          <h3 class="feature-title">GPS å®šä½äº’å‹•</h3>
          <p class="feature-description">èµ°åˆ°ä»»å‹™é»è‡ªå‹•è§¸ç™¼ï¼Œç¾å ´é«”é©—æœ€æœ‰æ„Ÿï¼</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img src="/images/feature-culture.png" alt="æ–‡åŒ–é–‹ç®±">
          </div>
          <h3 class="feature-title">æ–‡åŒ–ç¾é£Ÿé–‹ç®±</h3>
          <p class="feature-description">æ¯å€‹ä»»å‹™éƒ½æ˜¯ä¸€æ®µåœ¨åœ°æ•…äº‹ï¼Œæ·±å…¥äº†è§£åœ°æ–¹ç‰¹è‰²ã€‚</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img src="/images/feature-reward.png" alt="ä»»å‹™çå‹µ">
          </div>
          <h3 class="feature-title">ä»»å‹™æŒ‘æˆ°èˆ‡çå‹µ</h3>
          <p class="feature-description">å®Œæˆä»»å‹™å¯ç²å¾—çå‹µï¼Œé‚„èƒ½ç´¯ç©æˆå°±ï¼Œè®“æ—…ç¨‹æ›´æœ‰å‹•åŠ›ï¼</p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <img src="/images/feature-community.png" alt="ç¤¾ç¾¤äº’å‹•">
          </div>
          <h3 class="feature-title">ç¤¾ç¾¤äº’å‹•</h3>
          <p class="feature-description">èˆ‡æœ‹å‹ä¸€èµ·æŒ‘æˆ°ã€åˆ†äº«é«”é©—ï¼Œè®“åœ°æ–¹è¡ŒéŠ·æ›´æœ‰æº«åº¦ã€‚</p>
        </div>
      </div>
    </section>

    <!-- çµè«–å€åŸŸ -->
    <section class="conclusion-section" style="text-align:center; margin-top:50px; padding:30px; background:white; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.05);">
      <p class="conclusion-text" style="font-size:1.1rem; line-height:1.6; color:#555;">
        æœ¬å¹³å°è‡´åŠ›æ–¼å”åŠ©åœ°æ–¹ã€åé„‰ã€ç¤¾å€æ¨å»£ï¼Œ<br>
        è®“æ¯ä¸€ä½åƒèˆ‡è€…éƒ½èƒ½ç”¨éŠæˆ²åŒ–æ–¹å¼ï¼Œ
        <span style="color:#2196f3; font-weight:bold;">æ·±å…¥èªè­˜åœ¨åœ°æ–‡åŒ–ã€é¢¨æ™¯èˆ‡ç¾é£Ÿ</span>ï¼Œ<br>
        æ­¡è¿å„åœ°å–®ä½æ´½è«‡åˆä½œï¼
      </p>
    </section>
  </main>

  <footer>
    &copy; 2025 GPS ä»»å‹™ç³»çµ± - åœ°æ–¹é–‹ç®±ä»»å‹™éŠæˆ² | <a href="https://laijiubo.zeabur.app/" target="_blank" style="color: #6b7280; text-decoration: none;">ä¾†å°±è£œå¤šåª’é«”è¡ŒéŠ· è£½ä½œ</a>
  </footer>

  <script>
    // å‹•æ…‹é¡¯ç¤º staff/admin å°è¦½
    const loginUser = JSON.parse(localStorage.getItem('loginUser') || 'null');
    
    // åˆå§‹åŒ–å°è¦½åˆ—é¡¯ç¤º
    if (loginUser) {
        if (loginUser.role === 'admin') {
            document.getElementById('navStaff').style.display = '';
            document.getElementById('navRedeem').style.display = '';
            document.getElementById('navRoleMgmt').style.display = '';
        } else if (loginUser.role === 'shop') {
            document.getElementById('navStaff').style.display = '';
            document.getElementById('navRedeem').style.display = '';
        } else if (loginUser.role === 'user') {
            document.getElementById('navUserTasks').style.display = '';
        }
        
        // å·¥ä½œäººå“¡èˆ‡ç®¡ç†å“¡ä¸é¡¯ç¤ºä»»å‹™åˆ—è¡¨ (é¿å…æ··æ·†)
        if (loginUser.role === 'shop' || loginUser.role === 'admin') {
            const navTasksList = document.getElementById('navTasksList');
            if (navTasksList) navTasksList.style.display = 'none';
        }

        // é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
        document.getElementById('loginUserInfo').textContent = getUserDisplayName(loginUser);
        document.getElementById('logoutBtn').style.display = '';
        document.getElementById('logoutBtn').onclick = function() {
            localStorage.removeItem('loginUser');
            window.location.href = '/login.html';
        };

        // é¡¯ç¤ºæ­¡è¿è¨Šæ¯
        const authBtns = document.getElementById('authBtns');
        if (authBtns) {
            authBtns.innerHTML = `<div style="color:#2196f3; font-weight:bold; font-size:1.1rem;">æ­¡è¿å›ä¾†ï¼Œ${loginUser.username}ï¼</div>`;
        }
    } else {
        // æœªç™»å…¥ç‹€æ…‹
        document.getElementById('loginUserInfo').textContent = '';
        document.getElementById('logoutBtn').style.display = 'none';
        const authBtns = document.getElementById('authBtns');
        if (authBtns) {
            authBtns.innerHTML = `
                <button class="btn-secondary" onclick="window.location.href='/login.html'">ç™»å…¥</button>
                <button class="btn-secondary" onclick="window.location.href='/register.html'">è¨»å†Š</button>
            `;
        }
    }

    function getUserDisplayName(loginUser) {
      switch(loginUser.role) {
        case 'admin': return `ç®¡ç†å“¡ï¼š${loginUser.username}`;
        case 'shop': return `å•†åº—ï¼š${loginUser.username}`;
        case 'user': return `ç”¨æˆ¶ï¼š${loginUser.username}`;
        default: return loginUser.username;
      }
    }

    // æ¼¢å ¡é¸å–®åŠŸèƒ½
    document.getElementById('hamburgerBtn').onclick = function() {
      document.getElementById('headerContent').classList.toggle('open');
    };

    // é»æ“Šéˆæ¥å¾Œé—œé–‰é¸å–®
    document.querySelectorAll('.main-nav a').forEach(a => {
      a.onclick = () => document.getElementById('headerContent').classList.remove('open');
    });
  </script>
  <script src="/js/nav-access.js"></script>
</body>
</html>